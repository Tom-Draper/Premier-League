
{% extends 'layout.html' %} {% block content %}

<div class="row">
  <div class="row-left position-and-badge" style="background-image: url('static/img/club_badges/{{team_name_hyphenated}}.png'); background-repeat: no-repeat; background-size: auto 450px; background-position: right center;">
    <div class="position">{{ position }}</div>
  </div>
  <div class="fixtures-graph row-graph">
    <h1>Fixtures</h1>
    <!-- Not included in an iframe to ensure it loads before page is rendered -->
    <div class="graph mini-graph">
      {% include 'graphs/%s/fixtures-%s.html' % (team_name_hyphenated, team_name_hyphenated) %}
    </div>
  </div>
</div>
<div class="row">
  <div class="row-left form-details">
    <div class="current-form-row">
      <div class="icon pos-0 {{ form[0] }} {{ won_against_star_team[0] }}"></div>
      <div class="icon pos-1 {{ form[1] }} {{ won_against_star_team[1] }}"></div>
      <div class="icon pos-2 {{ form[2] }} {{ won_against_star_team[2] }}"></div>
      <div class="icon pos-3 {{ form[3] }} {{ won_against_star_team[3] }}"></div>
      <div class="icon pos-4 {{ form[4] }} {{ won_against_star_team[4] }}"></div>
    </div>
    <div class="current-form-row">
      <div class="icon-name pos-0">{{ recent_teams_played[0] }}</div>
      <div class="icon-name pos-1">{{ recent_teams_played[1] }}</div>
      <div class="icon-name pos-2">{{ recent_teams_played[2] }}</div>
      <div class="icon-name pos-3">{{ recent_teams_played[3] }}</div>
      <div class="icon-name pos-4">{{ recent_teams_played[4] }}</div>
    </div>
    <div class="current-form">Current Form: {{ form_rating }}%</div>
    <div class="table-snippet">
      <div class="divider"></div>
        <div class="table-row">
          <div class="table-element table-position column-title"></div>
          <div class="table-element table-team-name column-title">Team</div>
          <div class="table-element table-gd column-title">GD</div>
          <div class="table-element table-points column-title">Points</div>
        </div>

        {% for i in range(table_snippet|length) %}
          <!-- Divider -->
          {% if i == 0 %}
            {% if (i == table_index_of_this_team) %}
              <div id="big-divider"></div>
            {% else %}
              <div id="divider"></div>
            {% endif %}
          {% else %}
            {% if (i-1 == table_index_of_this_team) or (i == table_index_of_this_team) %}
              <div id="big-divider"></div>
            {% else %}
              <div id="divider"></div>
            {% endif %}
          {% endif %}

          <!-- Row of table -->
          {% if i == table_index_of_this_team %}
            <!-- Highlight this row as it is the team of the current page -->
            <div class="table-row this-team" style="background-color: var(--{{ team_name_hyphenated }});">
              <div class="table-element table-position this-team" style="color: var(--{{ team_name_hyphenated }}-secondary);">{{ table_snippet[i][0] }}</div>
              <div class="table-element table-team-name this-team" style="color: var(--{{ team_name_hyphenated }}-secondary);">{{ table_snippet[i][1] }}</div>
              <div class="table-element table-gd this-team" style="color: var(--{{ team_name_hyphenated }}-secondary);">{{ table_snippet[i][2] }}</div>
              <div class="table-element table-points this-team" style="color: var(--{{ team_name_hyphenated }}-secondary);">{{ table_snippet[i][3] }}</div>
            </div>
          {% else %}
            <!-- Generic row -->
            <div class="table-row">
              <div class="table-element table-position">{{ table_snippet[i][0] }}</div>
              <div class="table-element table-team-name">{{ table_snippet[i][1] }}</div>
              <div class="table-element table-gd">{{ table_snippet[i][2] }}</div>
              <div class="table-element table-points">{{ table_snippet[i][3] }}</div>
            </div>
          {% endif %}
        {% endfor %}

        {% if table_index_of_this_team == 6 %}
          <div id="big-divider"></div>
        {% else %}
          <div id="divider"></div>
        {% endif %}
    </div>
  </div>
  <div class="next-game-prediction row-graph" style="border: 6px solid var(--{{ team_playing_next_name_hypenated }});">
    <div class="next-game-title" style="background-color: var(--{{ team_playing_next_name_hypenated }});">
      <h1 class="next-game-title-text" style="color: var(--{{ team_playing_next_name_hypenated }}-secondary);">Next Game: {{ team_playing_next_name_hypenated.replace('-', ' ').title().replace('And', 'and') }} ({{ team_playing_next_home_away }})</h1>
    </div>
    <div class="next-game-values">
      <div class="predictions-and-logo">
        <div class="predictions">
          <div class="next-game-item">Current form: <b>{{ team_playing_next_form_rating }}%</b></div>
          <div class="next-game-item">Score prediction<br><b>{{ score_prediction }}</b></div>
        </div>
        <div class="next-game-logo opposition-badge"
            style="background-image: url('static/img/club_badges/{{ team_playing_next_name_hypenated }}.png');
                    background-repeat: no-repeat;
                    background-size: contain;
                    background-position: center;">
        </div>
      </div>
      <div class="past-results">
        <div class="next-game-item" style="font-weight:700;">Previous Results</div>
        
        <!-- Display table of previous results against the next team this team is playing -->
        {% for prev_meeting in team_playing_prev_meetings %}
          <div class="next-game-divider"></div>
          <div class="next-game-item {{ prev_meeting[5] }}">
            <div class="past-result">
              <div class="home-team">{{ prev_meeting[1] }}</div>
              <div class="score" style="font-weight:800">{{ prev_meeting[3] }} - {{ prev_meeting[4] }}</div>
              <div class="away-team">{{ prev_meeting[2] }}</div>
            </div>
            <div style="clear: both;"></div>
            <div class="past-result-date">{{ prev_meeting[0] }}</div>
          </div>
        {% endfor %}
        <div class="next-game-divider"></div>

      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="form-graph row-graph">
    <h1>Form Over Time</h1>
    <div class="graph full-row-graph">
      <iframe src="{{ 'static/graphs/{}/form-over-time-{}.html'.format(team_name_hyphenated, team_name_hyphenated) }}" style="border: none;" height=450px width=100%>
        Sorry your browser does not support inline frames.
     </iframe>
    </div>
  </div>
</div>
<div class="row">
  <div class="position-over-time-graph row-graph">
    <h1>Position Over Time</h1>
    <div class="graph full-row-graph">
      <iframe src="{{ 'static/graphs/{}/position-over-time-{}.html'.format(team_name_hyphenated, team_name_hyphenated) }}" style="border: none;" height=450px width=100%>
        Sorry your browser does not support inline frames.
     </iframe>
    </div>
  </div>
</div>
<div class="row" style="margin-bottom: 0;">
  <div class="goals-scored-vs-conceded-graph row-graph">
    <h1>Goals Scored and Conceded</h1>
    <div class="graph full-row-graph">
      <iframe src="{{ 'static/graphs/{}/goals-scored-and-conceded-{}.html'.format(team_name_hyphenated, team_name_hyphenated) }}" style="border: none;" height=450px width=100%>
        Sorry your browser does not support inline frames.
     </iframe>
    </div>
  </div>
</div>
<div class="row">
  <div class="clean-sheets row-graph">
    <div class="graph full-row-graph">
      <iframe src="{{ 'static/graphs/{}/clean-sheets-{}.html'.format(team_name_hyphenated, team_name_hyphenated) }}" style="border: none;" width=100%>
        Sorry your browser does not support inline frames.
     </iframe>
    </div>
  </div>
</div>
<div class="season-stats-row">
  <div class="season-stats">
    <div class="season-stat clean-sheet-ratio">
      <div class="season-stat-value">{{ clean_sheet_ratio }}</div>
      <div class="season-stat-text">clean sheets</div>
    </div>
    <div class="season-stat goals-per-game">
      <div class="season-stat-value">{{ goals_per_game }}</div>
      <div class="season-stat-text">goals per game</div>
    </div>
    <div class="season-stat conceded-per-game">
      <div class="season-stat-value">{{ conceded_per_game }}</div>
      <div class="season-stat-text">conceded per game</div>
    </div>
  </div>
</div>
<div class="footer">
  <div class="footer-item-gap footer-text-colour">
    Data provided by <a class="footer-text-colour underline" href="https://www.football-data.org/">football-data.org</a>
  </div>
  <div class="footer-item-gap footer-text-colour">
    Graphs created using <a class="footer-text-colour underline" href="https://plotly.com/">Plotly</a>
  </div>
  <div class="footer-item-gap footer-text-colour">
    Font made from <a class="footer-text-colour" href="http://www.onlinewebfonts.com">oNline Web Fonts</a> is licensed by CC BY 3.0
  </div>
  <div class="footer-item-gap footer-text-colour">
    Created by Tom Draper
  </div>
  <div class="footer-text-colour">
    v1.0
  </div>
  <!-- <a class="footer-item-gap-large footer-link donation-fontsize" href="https://www.paypal.me/TomDraper">
    <img class="donation" src="static/img/coin.png">
    <div class="donation-text footer-text-colour">Buy me a coffee</div>
  </a> -->
</div>
{% endblock content %}