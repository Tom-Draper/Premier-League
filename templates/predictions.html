<!DOCTYPE html>
<html>

<head>
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}" />
  <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" />
  <title>Predictions</title>
</head>

<body>
  <div class="predictions-header">
    <a class="predictions-title main-link" style="text-decoration: none" href="/predictions">Predictions</a>
  </div>

  <div class="page-content">
    <div class="accuracy-display">
      <div class="accuracy">
        <span class="accuracy-item">
          Predicting with accuracy: <b>{{ params.accuracy }}%</b></span><br />
        <div class="accuracy-item">
          General results accuracy: <b>{{ params.results_accuracy}}%</b>
        </div>
      </div>
    </div>

    <div class="predictions-container">
      <div class="predictions">
        {% if params.predictions != None %} {% for date, preds in
        params.predictions.items() %}
        <div class="date">
          {{ date[8:10] }}-{{ date[5:7] }}-{{ date[:4] }}
        </div>
        <div class="medium-predictions-divider"></div>
        {% for pred in preds %}
        <button class="prediction-container {{ pred['colour'] }}" onclick="toggleDetailsDisplay('{{ pred['_id'] }}')">
          <div class="prediction prediction-item">
            <div class="prediction-label">Predicted:</div>
            <div class="prediction-value">
              <div class="prediction-initials">{{ pred['home'] }}</div>
              <div class="prediction-score">
                {{ pred['prediction']['homeGoals']|round|int }} - {{
                pred['prediction']['awayGoals']|round|int }}
              </div>
              <div class="prediction-initials">{{ pred['away'] }}</div>
            </div>
          </div>
          {% if pred['actual'] != None %}
          <div class="actual prediction-item">
            <div class="prediction-label">Actual:</div>
            <div class="prediction-value">
              <div class="prediction-initials">{{ pred['home'] }}</div>
              <div class="prediction-score">
                {{ pred['actual']['homeGoals'] }} - {{
                pred['actual']['awayGoals'] }}
              </div>
              <div class="prediction-initials">{{ pred['away'] }}</div>
            </div>
          </div>
          {% else %}
          <div class="prediction-time">{{ pred['time'] }}</div>
          {% endif %}

          <!-- Toggle to see detailed score (float version) -->
          {% if pred['prediction'] != None %}
          <div class="prediction-details" id="{{ pred['_id'] }}">
            <div class="detailed-predicted-score">
              <b>
                {{ pred['prediction']['homeGoals'] }} - {{
                pred['prediction']['awayGoals']}}</b>
            </div>
          </div>
          {% endif %}
        </button>
        {% endfor %}
        <div class="predictions-gap"></div>
        {% endfor %} {% endif %}
      </div>
    </div>
  </div>

  <div class="predictions-footer footer-text-colour">
    <script type="text/javascript" src="https://storage.ko-fi.com/cdn/widget/Widget_2.js"></script>
    <script type="text/javascript">
      kofiwidget2.init("Support Me", "#d9534f", "C0C069FOI");
      kofiwidget2.draw();
      </script>
    <div class="method-description">Predictions are calculated using previous results and then adjusting by recent form and home advantage.</div>
    <div class="last-updated">{{ params.last_updated }} UTC</div>
  </div>

  <script>
    function toggleDetailsDisplay(id) {
      let prediction = document.getElementById(id);
      if (prediction != null) {
        prediction.classList.toggle("expanded");
      }
    }
  </script>
</body>

</html>

'